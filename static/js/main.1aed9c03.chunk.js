(this.webpackJsonpwebmd=this.webpackJsonpwebmd||[]).push([[0],{280:function(e,t,a){e.exports=a.p+"static/media/chrome-icon.f3b6c54c.svg"},312:function(e,t,a){e.exports=a(553)},336:function(e,t){},338:function(e,t){},370:function(e,t){},371:function(e,t){},504:function(e,t){},506:function(e,t){},536:function(e,t,a){},537:function(e,t,a){},552:function(e,t,a){e.exports=function(){return new Worker(a.p+"ffb88193b05ec63929fd.worker.js")}},553:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(16),i=a.n(l),o=a(18);const c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const a=e.installing;null!=a&&(a.onstatechange=()=>{console.log("state change",a.state),"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})},e.update()}).catch(e=>{console.error("Error during service worker registration:",e)})}var d=a(33),m=a(22),u=a(270);function p(e){return new Promise(t=>{setTimeout(t,e)})}async function g(e,t){let a=1,n=setInterval(()=>{a++,t(Math.min(100,1e3*a/e*100))},1e3);await p(e),window.clearInterval(n)}function b(e){return Object(o.d)(e,o.b)}function f(e){return`/webminidisc/${e}`}function h(e,t){localStorage.setItem(e,JSON.stringify(t))}function v(e,t){let a=localStorage.getItem(e);if(null===a)return t;try{return JSON.parse(a)}catch(n){return t}}function y(e){return e.normalize("NFD").replace(/[^\x00-\x7F]/g,"")}const E={[m.Encoding.sp]:"SP",[m.Encoding.lp2]:"LP2",[m.Encoding.lp4]:"LP4"};function w(e){let t=[];if(null!==e)for(let r of e.groups)for(let e of r.tracks){var a,n;t.push({index:e.index,title:null!==(a=e.title)&&void 0!==a?a:"Unknown Title",group:null!==(n=r.title)&&void 0!==n?n:"",encoding:E[e.encoding],duration:Object(m.formatTimeFromFrames)(e.duration,!1)})}return t.sort((e,t)=>e.index-t.index),t}function k(e,t,a){const n=a.value;return a.value=async function(...e){const t=this.mutex,a=await t.acquire();try{return await n.apply(this,e)}finally{a()}},a}function C(e){return e.breakpoints.up(600+2*e.spacing(2))}function O(e){return e.breakpoints.down(600+2*e.spacing(2))}function j(e){return e.breakpoints.up(700+2*e.spacing(2))+" and (min-height: 750px)"}var D,S=a(293);const x=a(437);let M=(D=class{constructor({debug:e=!1}){if(this.netmdInterface=void 0,this.logger=void 0,this.mutex=new S.a,this.statusMonitorTimer=void 0,e){const e=(...e)=>{e&&e[0]&&e[0].method&&console.log(...e)};this.logger={debug:e,info:e,warn:e,error:e,child:()=>this.logger}}}async pair(){let e=await Object(m.openNewDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async connect(){let e=await Object(m.openPairedDevice)(navigator.usb,this.logger);return null!==e&&(this.netmdInterface=e,!0)}async listContent(){return await Object(m.listContent)(this.netmdInterface)}async getDeviceStatus(){return await Object(m.getDeviceStatus)(this.netmdInterface)}async getDeviceName(){return await this.netmdInterface.netMd.getDeviceName()}async finalize(){await this.netmdInterface.netMd.finalize()}async renameTrack(e,t){t=y(t),await this.netmdInterface.cacheTOC(),await this.netmdInterface.setTrackTitle(e,t),await this.netmdInterface.syncTOC()}async renameDisc(e){const t=await this.netmdInterface.getDiscTitle(),a=await this.netmdInterface._getDiscTitle(),n=a.indexOf("//")>=0,r=a.startsWith("0;");if(e===t)return;let l;l=n?r?a.replace(/^0;.*?\/\//,""!==e?`0;${e}//`:""):`0;${e}//${a}`:e,await this.netmdInterface.cacheTOC(),await this.netmdInterface.setDiscTitle(l),await this.netmdInterface.syncTOC()}async deleteTrack(e){await this.netmdInterface.eraseTrack(e),await p(100)}async wipeDisc(){await this.netmdInterface.eraseDisc()}async moveTrack(e,t){await this.netmdInterface.moveTrack(e,t)}async upload(e,t,a,n){let r=t.byteLength,l=0,i=0;function o(){n({written:l,encrypted:i,total:r})}let c=new x,s=Object(u.makeGetAsyncPacketIteratorOnWorkerThread)(c,({encryptedBytes:e})=>{i=e,o()});e=y(e);let d=new m.MDTrack(e,a,t,524288,s);await Object(m.download)(this.netmdInterface,d,({writtenBytes:e})=>{l=e,o()}),c.terminate()}async play(){await this.netmdInterface.play()}async pause(){await this.netmdInterface.pause()}async stop(){await this.netmdInterface.stop()}async next(){await this.netmdInterface.nextTrack()}async prev(){await this.netmdInterface.previousTrack()}async gotoTrack(e){await this.netmdInterface.gotoTrack(e)}async getPosition(){return await this.netmdInterface.getPosition()}},Object(d.a)(D.prototype,"listContent",[k],Object.getOwnPropertyDescriptor(D.prototype,"listContent"),D.prototype),Object(d.a)(D.prototype,"getDeviceStatus",[k],Object.getOwnPropertyDescriptor(D.prototype,"getDeviceStatus"),D.prototype),Object(d.a)(D.prototype,"getDeviceName",[k],Object.getOwnPropertyDescriptor(D.prototype,"getDeviceName"),D.prototype),Object(d.a)(D.prototype,"finalize",[k],Object.getOwnPropertyDescriptor(D.prototype,"finalize"),D.prototype),Object(d.a)(D.prototype,"renameTrack",[k],Object.getOwnPropertyDescriptor(D.prototype,"renameTrack"),D.prototype),Object(d.a)(D.prototype,"renameDisc",[k],Object.getOwnPropertyDescriptor(D.prototype,"renameDisc"),D.prototype),Object(d.a)(D.prototype,"deleteTrack",[k],Object.getOwnPropertyDescriptor(D.prototype,"deleteTrack"),D.prototype),Object(d.a)(D.prototype,"wipeDisc",[k],Object.getOwnPropertyDescriptor(D.prototype,"wipeDisc"),D.prototype),Object(d.a)(D.prototype,"moveTrack",[k],Object.getOwnPropertyDescriptor(D.prototype,"moveTrack"),D.prototype),Object(d.a)(D.prototype,"play",[k],Object.getOwnPropertyDescriptor(D.prototype,"play"),D.prototype),Object(d.a)(D.prototype,"pause",[k],Object.getOwnPropertyDescriptor(D.prototype,"pause"),D.prototype),Object(d.a)(D.prototype,"stop",[k],Object.getOwnPropertyDescriptor(D.prototype,"stop"),D.prototype),Object(d.a)(D.prototype,"next",[k],Object.getOwnPropertyDescriptor(D.prototype,"next"),D.prototype),Object(d.a)(D.prototype,"prev",[k],Object.getOwnPropertyDescriptor(D.prototype,"prev"),D.prototype),Object(d.a)(D.prototype,"gotoTrack",[k],Object.getOwnPropertyDescriptor(D.prototype,"gotoTrack"),D.prototype),Object(d.a)(D.prototype,"getPosition",[k],Object.getOwnPropertyDescriptor(D.prototype,"getPosition"),D.prototype),D);var T={},N=a(49),P=a(23),I=a(17);const z=Object(P.b)({name:"uploadDialog",initialState:{visible:!1,cancelled:!1,writtenProgress:0,encryptedProgress:0,totalProgress:1,trackTotal:1,trackConverting:0,trackCurrent:0,titleCurrent:"",titleConverting:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setWriteProgress:(e,t)=>{e.encryptedProgress=t.payload.encrypted,e.writtenProgress=t.payload.written,e.totalProgress=t.payload.total},setCancelUpload:(e,t)=>{e.cancelled=t.payload},setTrackProgress:(e,t)=>{e.trackTotal=t.payload.total,e.trackCurrent=t.payload.current,e.trackConverting=t.payload.converting,e.titleCurrent=t.payload.titleCurrent,e.titleConverting=t.payload.titleConverting}}}),{reducer:R,actions:F}=z;var W=Object(I.enableBatching)(R);const A=Object(P.b)({name:"renameDialog",initialState:{visible:!1,title:"",index:-1},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setCurrentName:(e,t)=>{e.title=t.payload},setIndex:(e,t)=>{e.index=t.payload}}}),{reducer:L,actions:B}=A;var $=Object(I.enableBatching)(L);const V={visible:!1,error:""},U=Object(P.b)({name:"errorDialog",initialState:V,reducers:{setVisible:(e,t)=>{e.visible=t.payload},setErrorMessage:(e,t)=>{e.error=`${t.payload}`}}}),{actions:_,reducer:H}=U;var G=Object(I.enableBatching)(H);const J=Object(P.b)({name:"panicDialog",initialState:{visible:!1,dismissed:!1},reducers:{setVisible:(e,t)=>{e.visible=t.payload},dismiss:(e,t)=>{e.visible=!1,e.dismissed=!0}}}),{actions:q,reducer:Y}=J;var K=Object(I.enableBatching)(Y);const X={visible:!1,format:v("uploadFormat","LP2"),titleFormat:v("trackTitleFormat","filename")},Q=Object(P.b)({name:"convertDialog",initialState:X,reducers:{setVisible:(e,t)=>{e.visible=t.payload},setFormat:(e,t)=>{e.format=t.payload,h("uploadFormat",e.format)},setTitleFormat:(e,t)=>{e.titleFormat=t.payload,h("trackTitleFormat",e.titleFormat)}}}),{actions:Z,reducer:ee}=Q;var te=Object(I.enableBatching)(ee);const ae=Object(P.b)({name:"dumpDialog",initialState:{visible:!1,inputDeviceId:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setInputDeviceId:(e,t)=>{e.inputDeviceId=t.payload}}}),{reducer:ne,actions:re}=ae;var le=Object(I.enableBatching)(ne);const ie=Object(P.b)({name:"recordDialog",initialState:{visible:!1,trackTotal:1,trackDone:0,trackCurrent:0,titleCurrent:""},reducers:{setVisible:(e,t)=>{e.visible=t.payload},setProgress:(e,t)=>{e.trackTotal=t.payload.trackTotal,e.trackDone=t.payload.trackDone,e.trackCurrent=t.payload.trackCurrent,e.titleCurrent=t.payload.titleCurrent}}}),{reducer:oe,actions:ce}=ie;var se=Object(I.enableBatching)(oe);const de={mainView:"WELCOME",loading:!1,pairingFailed:!1,pairingMessage:"",browserSupported:!0,darkMode:v("darkMode",!1),aboutDialogVisible:!1},me=Object(P.b)({name:"app",initialState:de,reducers:{setState:(e,t)=>{e.mainView=t.payload},setLoading:(e,t)=>{e.loading=t.payload},setPairingFailed:(e,t)=>{e.pairingFailed=t.payload},setPairingMessage:(e,t)=>{e.pairingMessage=t.payload},setBrowserSupported:(e,t)=>{e.browserSupported=t.payload},setDarkMode:(e,t)=>{e.darkMode=t.payload,h("darkMode",e.darkMode)},showAboutDialog:(e,t)=>{e.aboutDialogVisible=t.payload}}}),{reducer:ue,actions:pe}=me;var ge=Object(I.enableBatching)(ue);const be=Object(P.b)({name:"main",initialState:{disc:null,deviceName:"",deviceStatus:null},reducers:{setDisc:(e,t)=>{e.disc=t.payload},setDeviceName:(e,t)=>{e.deviceName=t.payload},setDeviceStatus:(e,t)=>{e.deviceStatus=t.payload}}}),{reducer:fe,actions:he}=be;var ve=Object(I.enableBatching)(fe);let ye=Object(N.c)({renameDialog:$,uploadDialog:W,errorDialog:G,panicDialog:K,convertDialog:te,dumpDialog:le,recordDialog:se,appState:ge,main:ve});const Ee=pe.setState.toString(),we=Object(P.a)({reducer:function(...e){const[t,a]=e;return a.type===Ee&&"WELCOME"===a.payload?ke:ye(...e)},middleware:[e=>e=>async t=>{try{await e(t)}catch(a){console.error(a),e(q.setVisible(!0))}},...Object(P.c)()]}),ke=Object.freeze(we.getState());var Ce=a(621),Oe=a(558),je=a(622),De=a(599),Se=a(292),xe=a(614),Me=a(271);function Te(e,t){return async function(a,n){switch(e){case"play":await T.netmdService.play();break;case"stop":await T.netmdService.stop();break;case"next":await T.netmdService.next();break;case"prev":await T.netmdService.prev();break;case"goto":t&&"number"===typeof t&&t>=0&&await T.netmdService.gotoTrack(t)}await p(500);try{let e=await T.netmdService.getDeviceStatus();a(he.setDeviceStatus(e))}catch(r){console.log("control: Cannot get device status")}}}function Ne(){return async function(e){e(pe.setLoading(!0));let t=await T.netmdService.listContent(),a=await T.netmdService.getDeviceName(),n=null;try{n=await T.netmdService.getDeviceStatus()}catch(r){console.log("listContent: Cannot get device status")}e(Object(I.batchActions)([he.setDisc(t),he.setDeviceName(a),he.setDeviceStatus(n),pe.setLoading(!1)]))}}const Pe={SP:m.Wireformat.pcm,LP2:m.Wireformat.lp2,LP105:m.Wireformat.l105kbps,LP4:m.Wireformat.lp4};async function Ie(e,t){var a,n,r;const l=await e.arrayBuffer(),i=new Blob([new Uint8Array(l)]);let o=await Me.parseBlob(i);const c=null!==(a=o.common.title)&&void 0!==a?a:"Unknown Title",s=null!==(n=o.common.artist)&&void 0!==n?n:"Unknown Artist",d=null!==(r=o.common.album)&&void 0!==r?r:"Unknown Album";switch(t){case"title":return c;case"artist-title":return`${s} - ${c}`;case"album-title":return`${d} - ${c}`;case"artist-album-title":return`${s} - ${d} - ${c}`;case"filename":{let t=e.name;const a=t.lastIndexOf(".");return a>0&&(t=t.substring(0,a)),t}}}function ze(e,t,a){return async function(n,r){const{audioExportService:l,netmdService:i}=T,o=Pe[t];await(null===i||void 0===i?void 0:i.stop()),n(Object(I.batchActions)([F.setVisible(!0),F.setCancelUpload(!1)]));const c=({written:e,encrypted:t,total:a})=>{n(F.setWriteProgress({written:e,encrypted:t,total:a}))},s=()=>r().uploadDialog.cancelled;let d={current:0,converting:0,total:e.length,titleCurrent:"",titleConverting:""};const u=()=>{n(F.setTrackProgress(d))};let p=r().main.disc,g=p?1700-Object(m.getTracks)(p).map(e=>e.title||"").reduce((e,t)=>e+t.length,0):-1;let b;g=Math.floor(g/e.length);let f="",h=1;for await(let m of async function*(e){let a=[],n=0;!function r(){if(n===e.length||s())return d.converting=n,d.titleConverting="",void u();let i=e[n];d.converting=n,d.titleConverting=i.name,u(),n++,a.push(new Promise(async(e,a)=>{let n;try{await l.prepare(i),n=await l.export({format:t}),r(),e({file:i,data:n})}catch(o){b=o,f=`${i.name}: Unsupported or unrecognized format`,a(o)}}))}();let r=0;for(;r<a.length;)yield await a[r],delete a[r],r++}(e)){if(s())break;const{file:e,data:t}=m;let n=e.name;try{n=await Ie(e,a)}catch(y){console.error(y)}g>-1&&(n=n.substring(0,g)),d.current=h++,d.titleCurrent=n,u(),c({written:0,encrypted:0,total:100});try{await(null===i||void 0===i?void 0:i.upload(n,t,o,c))}catch(y){b=y,f=`${e.name}: Error uploading to device`;break}}let v=[F.setVisible(!1)];b&&(console.error(b),v=v.concat([_.setVisible(!0),_.setErrorMessage(f)])),n(Object(I.batchActions)(v)),Ne()(n)}}var Re=a(598),Fe=a(83),We=a(606),Ae=a(607),Le=a(628),Be=a(596),$e=a(590),Ve=a(597),Ue=a(594),_e=a(595),He=a(593),Ge=a(589);const Je=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),qe=e=>{const t=Object(o.c)();let a=b(e=>e.appState.aboutDialogVisible);return r.a.createElement($e.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:Je,"aria-labelledby":"about-dialog-slide-title"},r.a.createElement(He.a,{id:"about-dialog-slide-title"},"About Web MiniDisc"),r.a.createElement(Ue.a,null,r.a.createElement(_e.a,null,"Web MiniDisc has been made possible by"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://www.ffmpeg.org/",target:"_blank"},"FFmpeg")," ","and"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://github.com/ffmpegjs/FFmpeg",target:"_blank"},"ffmpegjs"),", to read your audio files (wav, mp3, ogg, mp4, etc...)."),r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://github.com/dcherednik/atracdenc/",target:"_blank"},"Atracdenc"),", to support atrac3 encoding (lp2, lp4 audio formats)."),r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://emscripten.org/",target:"_blank"},"Emscripten"),", to run both FFmpeg and Atracdenc in the browser."),r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/netmd-js",target:"_blank"},"netmd-js"),", to send commands to NetMD devices using Javascript."),r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://github.com/glaubitz/linux-minidisc",target:"_blank"},"linux-minidisc"),", to make the netmd-js project possible."),r.a.createElement("li",null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://material-ui.com/",target:"_blank"},"material-ui"),", to build the user interface.")),r.a.createElement(_e.a,null,"Attribution"),r.a.createElement("ul",null,r.a.createElement("li",null,"MiniDisc logo from"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://en.wikipedia.org/wiki/MiniDisc",target:"_blank"},"https://en.wikipedia.org/wiki/MiniDisc")),r.a.createElement("li",null,"MiniDisc icon from"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://www.deviantart.com/blinkybill/art/Sony-MiniDisc-Plastic-Icon-473812540",target:"_blank"},"http://fav.me/d7u3g3g")))),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:()=>{t(pe.showAboutDialog(!1))}},"Close")))};var Ye=a(560),Ke=a(294),Xe=a(600),Qe=a(279),Ze=a.n(Qe),et=a(601),tt=a(602),at=a(272),nt=a.n(at),rt=a(149),lt=a.n(rt),it=a(278),ot=a.n(it),ct=a(273),st=a.n(ct),dt=a(274),mt=a.n(dt),ut=a(277),pt=a.n(ut),gt=a(276),bt=a.n(gt),ft=a(275),ht=a.n(ft);const vt=Object(De.a)(e=>({listItemIcon:{minWidth:e.spacing(5)}})),yt=function(){const e=vt(),t=Object(o.c)();let{mainView:a,darkMode:l}=b(e=>e.appState),i=b(e=>{var t,a;return null!==(t=null===(a=e.main.disc)||void 0===a?void 0:a.title)&&void 0!==t?t:""});const c=r.a.useRef(null),[s,d]=r.a.useState(null),m=Boolean(s),u=Object(n.useCallback)(e=>{d(e.currentTarget)},[d]),p=Object(n.useCallback)(()=>{t(pe.setDarkMode(!l))},[t,l]),g=Object(n.useCallback)(()=>{d(null)},[d]),f=Object(n.useCallback)(()=>{t((async function(e){if(!window.confirm("Proceed with Wipe Disc? This operation cannot be undone."))return;const{netmdService:t}=T;e(pe.setLoading(!0)),await t.wipeDisc(),Ne()(e)})),g()},[t,g]),h=Object(n.useCallback)(()=>{t(Ne()),g()},[t,g]),v=Object(n.useCallback)(()=>{t(Object(I.batchActions)([B.setVisible(!0),B.setCurrentName(i),B.setIndex(-1)])),g()},[t,g,i]),y=Object(n.useCallback)(()=>{t(pe.setState("WELCOME")),g()},[t,g]),E=Object(n.useCallback)(()=>{t(pe.showAboutDialog(!0)),g()},[t,g]),w=Object(n.useCallback)(e=>{var t;(e.stopPropagation(),e.target!==c.current)&&(null===(t=c.current)||void 0===t||t.click());g()},[g]),k=[];return"MAIN"===a&&(k.push(r.a.createElement(Xe.a,{key:"update",onClick:h},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(nt.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"Reload TOC"))),k.push(r.a.createElement(Xe.a,{key:"title",onClick:v},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(lt.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"Rename Disc"))),k.push(r.a.createElement(Xe.a,{key:"wipe",onClick:f},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(st.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"Wipe Disc"))),k.push(r.a.createElement(Xe.a,{key:"exit",onClick:y},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(mt.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"Exit")))),k.push(r.a.createElement(Xe.a,{key:"darkMode",onClick:p},r.a.createElement(et.a,{className:e.listItemIcon},l?r.a.createElement(ht.a,{fontSize:"small"}):r.a.createElement(bt.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"Dark Mode"))),k.push(r.a.createElement(Xe.a,{key:"about",onClick:E},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(pt.a,{fontSize:"small"})),r.a.createElement(tt.a,null,"About"))),k.push(r.a.createElement(Xe.a,{key:"github",onClick:w},r.a.createElement(et.a,{className:e.listItemIcon},r.a.createElement(ot.a,{fontSize:"small"})),r.a.createElement(tt.a,null,r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"https://github.com/cybercase/webminidisc",target:"_blank",ref:c,onClick:w},"Fork me on GitHub")))),r.a.createElement(r.a.Fragment,null,r.a.createElement(Ye.a,{"aria-label":"actions","aria-controls":"actions-menu","aria-haspopup":"true",onClick:u},r.a.createElement(Ze.a,null)),r.a.createElement(Ke.a,{id:"actions-menu",anchorEl:s,keepMounted:!0,open:m,onClose:g},k))};var Et=a(280),wt=a.n(Et);const kt=Object(De.a)(e=>({main:{position:"relative",flex:"1 1 auto",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},button:{marginTop:e.spacing(3),minWidth:150},spacing:{marginTop:e.spacing(1)},chromeLogo:{marginTop:e.spacing(1),width:96,height:96},why:{alignSelf:"flex-start",marginTop:e.spacing(3)},headBox:{display:"flex",justifyContent:"space-between"}})),Ct=e=>{const t=kt(),a=Object(o.c)(),{browserSupported:l,pairingFailed:i,pairingMessage:c}=b(e=>e.appState);c.toLowerCase().match(/denied/);const[s,d]=Object(n.useState)(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Le.a,{className:t.headBox},r.a.createElement(Fe.a,{component:"h1",variant:"h4"},"Web MiniDisc"),r.a.createElement(yt,null)),r.a.createElement(Fe.a,{component:"h2",variant:"body2"},"Brings NetMD Devices to the Web"),r.a.createElement(Le.a,{className:t.main},l?r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Press the button to connect to a NetMD device"),r.a.createElement(Re.a,{variant:"contained",color:"primary",onClick:()=>a((async function(e,t){e(pe.setPairingFailed(!1)),await T.audioExportService.init();try{if(await T.netmdService.connect())return void e(pe.setState("MAIN"))}catch(a){console.error(a)}try{if(await T.netmdService.pair())return void e(pe.setState("MAIN"));e(Object(I.batchActions)([pe.setPairingMessage("Connection Failed"),pe.setPairingFailed(!0)]))}catch(a){console.error(a);let t=a.message;e(Object(I.batchActions)([pe.setPairingMessage(t),pe.setPairingFailed(!0)]))}})),className:t.button},"Connect"),r.a.createElement(We.a,{error:!0,className:t.spacing,style:{visibility:i?"visible":"hidden"}},r.a.createElement(Ae.a,null,c))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"This Web browser is not supported.\xa0",r.a.createElement(Be.a,{rel:"noopener noreferrer",href:"#",onClick:e=>{e.preventDefault(),d(!0)}},"Learn Why")),r.a.createElement(Be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},r.a.createElement("img",{alt:"Chrome Logo",src:wt.a,className:t.chromeLogo})),r.a.createElement(Fe.a,{component:"h2",variant:"subtitle1",align:"center",className:t.spacing},"Try using"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://www.google.com/chrome/"},"Chrome")," ","instead"),s?r.a.createElement(r.a.Fragment,null,r.a.createElement(Fe.a,{component:"p",variant:"body2",className:t.why},"Web MiniDisc requires a browser that supports both"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://wicg.github.io/webusb/"},"WebUSB")," ","and"," ",r.a.createElement(Be.a,{rel:"noopener noreferrer",target:"_blank",href:"https://webassembly.org/"},"WebAssembly"),"."),r.a.createElement("ul",null,r.a.createElement("li",null,"WebUSB is needed to control the NetMD device via the USB connection to your computer."),r.a.createElement("li",null,"WebAssembly is used to convert the music to a MiniDisc compatible format"))):null)),r.a.createElement(qe,null))};var Ot=a(3),jt=a(153),Dt=a(12),St=a(620),xt=a(151),Mt=a.n(xt),Tt=a(290),Nt=a.n(Tt),Pt=a(615),It=a(619),zt=a(618),Rt=a(616),Ft=a(617),Wt=a(612),At=a(629),Lt=a(627);const Bt=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),$t=e=>{let t=Object(o.c)(),a=b(e=>e.renameDialog.visible),n=b(e=>e.renameDialog.title),l=b(e=>e.renameDialog.index);const i=l<0?"Disc":"Track",c=()=>{t(B.setVisible(!1))},s=()=>{t(l<0?function({newName:e}){return async function(t){const{netmdService:a}=T;await a.renameDisc(e),t(B.setVisible(!1)),Ne()(t)}}({newName:n}):function({index:e,newName:t}){return async function(a){const{netmdService:n}=T;a(B.setVisible(!1));try{await n.renameTrack(e,t)}catch(r){console.error(r),a(Object(I.batchActions)([_.setVisible(!0),_.setErrorMessage("Rename failed.")]))}Ne()(a)}}({index:l,newName:n}))};return r.a.createElement($e.a,{open:a,onClose:c,maxWidth:"sm",fullWidth:!0,TransitionComponent:Bt,"aria-labelledby":"rename-dialog-title"},r.a.createElement(He.a,{id:"rename-dialog-title"},"Rename ",i),r.a.createElement(Ue.a,null,r.a.createElement(Lt.a,{autoFocus:!0,id:"name",label:`${i} Name`,type:"text",fullWidth:!0,value:n,onKeyDown:e=>{"Enter"===e.key&&s()},onChange:e=>{t(B.setCurrentName(e.target.value.substring(0,120)))}})),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:c},"Cancel"),r.a.createElement(Re.a,{color:"primary",onClick:s},"Rename")))};var Vt=a(610);const Ut=Object(De.a)(e=>({progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)},uploadLabel:{marginTop:e.spacing(3)}})),_t=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),Ht=e=>{const t=Ut(),a=Object(o.c)();let{visible:l,cancelled:i,writtenProgress:c,encryptedProgress:s,totalProgress:d,trackTotal:m,trackCurrent:u,trackConverting:p,titleCurrent:g,titleConverting:f}=b(e=>e.uploadDialog);const h=Object(n.useCallback)(()=>{a(F.setCancelUpload(!0))},[a]);let v=Math.floor(c/d*100),y=Math.floor(s/d*100),E=Math.floor(p/m*100);return r.a.createElement($e.a,{open:l,maxWidth:"sm",fullWidth:!0,TransitionComponent:_t,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},r.a.createElement(He.a,{id:"alert-dialog-slide-title"},"Recording..."),r.a.createElement(Ue.a,null,r.a.createElement(_e.a,{id:"alert-dialog-slide-description"},100===E&&p===m?"Conversion completed":`Converting ${p+1} of ${m}: ${f}`),r.a.createElement(Vt.a,{className:t.progressBar,variant:0===E?"indeterminate":"determinate",color:"primary",value:E}),r.a.createElement(Le.a,{className:t.progressPerc},E,"%"),r.a.createElement(_e.a,{id:"alert-dialog-slide-description",className:t.uploadLabel},"Uploading ",u," of ",m,": ",g),r.a.createElement(Vt.a,{className:t.progressBar,variant:"buffer",color:"secondary",value:v,valueBuffer:y}),r.a.createElement(Le.a,{className:t.progressPerc},v,"%")),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{disabled:i,onClick:h},i?"Stopping after current track...":"Cancel Recording")))},Gt=Object(De.a)(e=>({progressPerc:{marginTop:e.spacing(1)},progressBar:{marginTop:e.spacing(3)}})),Jt=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),qt=e=>{const t=Gt();let{visible:a,trackTotal:n,trackDone:l,trackCurrent:i,titleCurrent:o}=b(e=>e.recordDialog),c=Math.round(i);return r.a.createElement($e.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:Jt,"aria-labelledby":"record-dialog-slide-title","aria-describedby":"record-dialog-slide-description"},r.a.createElement(He.a,{id:"record-dialog-slide-title"},"Recording..."),r.a.createElement(Ue.a,null,r.a.createElement(_e.a,{id:"record-dialog-slide-description"},`Recording track ${l+1} of ${n}: ${o}`),r.a.createElement(Vt.a,{className:t.progressBar,variant:i>=0?"determinate":"indeterminate",color:"primary",value:c}),r.a.createElement(Le.a,{className:t.progressPerc},c>=0?`${c}%`:"")),r.a.createElement(Ve.a,null))},Yt=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),Kt=e=>{const t=Object(o.c)();let{visible:a,error:l}=b(e=>e.errorDialog);const i=Object(n.useCallback)(()=>{t(_.setVisible(!1))},[t]);return r.a.createElement($e.a,{open:a,maxWidth:"sm",fullWidth:!0,TransitionComponent:Yt,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},r.a.createElement(He.a,{id:"alert-dialog-slide-title"},"Error"),r.a.createElement(Ue.a,null,r.a.createElement(_e.a,{id:"alert-dialog-slide-description"},l)),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:i},"Close")))},Xt=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),Qt=e=>{const t=Object(o.c)();let{visible:a,dismissed:l}=b(e=>e.panicDialog);const i=Object(n.useCallback)(()=>{window.location.reload()},[]),c=Object(n.useCallback)(()=>{t(q.dismiss())},[t]);return r.a.createElement($e.a,{open:a&&!l,maxWidth:"sm",fullWidth:!0,scroll:"paper",TransitionComponent:Xt,"aria-labelledby":"error-dialog-slide-title","aria-describedby":"error-dialog-slide-description"},r.a.createElement(He.a,{id:"alert-dialog-slide-title"},"Oops\u2026 Something unexpected happened."),r.a.createElement(Ue.a,null,r.a.createElement(Fe.a,{color:"textSecondary",variant:"body1",component:"div"},"Try to restart the app. If the error persists, try the followings:",r.a.createElement("ol",null,r.a.createElement("li",null,"Use your browser in incognito mode."),r.a.createElement("li",null,"Use a blank MiniDisc."),r.a.createElement("li",null,"Try to use Web MiniDisc on another computer.")),"If this does not solve the error, your unit might not be supported yet or you have encountered a bug. The full error is reported in the JS console.")),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:c,size:"small"},"Ignore and Continue"),r.a.createElement(Re.a,{onClick:i,color:"primary"},"Restart the App")))};var Zt=a(611),ea=a(631),ta=a(624),aa=a(608),na=a(626),ra=a(613),la=a(283),ia=a.n(la),oa=a(284),ca=a.n(oa),sa=a(282),da=a.n(sa),ma=a(604),ua=a(559),pa=a(623);const ga=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),ba=Object(De.a)(e=>({container:{display:"flex",flexDirection:"row"},formControl:{minWidth:60},toggleButton:{minWidth:40},dialogContent:{display:"flex",flexDirection:"column",justifyContent:"stretch"},formatAndTitle:{display:"flex",flexWrap:"wrap",justifyContent:"space-between"},rightBlock:{display:"flex",flexDirection:"column"},titleFormControl:{minWidth:170,marginTop:4,[O(e)]:{width:114,minWidth:0}},spacer:{display:"flex",flex:"1 1 auto"},showTracksOrderBtn:{marginLeft:e.spacing(1)},tracksOrderAccordion:{"&:before":{opacity:0}},tracksOrderAccordionDetail:{maxHeight:"40vh",overflow:"auto"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Dt.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},trackList:{flex:"1 1 auto"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})),fa=e=>{const t=Object(o.c)(),a=ba();let{visible:l,format:i,titleFormat:c}=b(e=>e.convertDialog);const[s,d]=Object(n.useState)(e.files),[m,u]=Object(n.useState)(-1),p=Object(n.useCallback)(e=>{const t=m+e;if(t>=s.length||t<0)return;const a=s.slice();let n=a[m];a[m]=a[t],a[t]=n,d(a),u(t)},[s,m]),g=Object(n.useCallback)(()=>{p(-1)},[p]),f=Object(n.useCallback)(()=>{p(1)},[p]),h=Object(n.useCallback)(()=>{t(Z.setVisible(!1))},[t]),v=Object(n.useCallback)((e,a)=>{null!==a&&t(Z.setFormat(a))},[t]),y=Object(n.useCallback)(e=>{t(Z.setTitleFormat(e.target.value))},[t]),E=Object(n.useCallback)(()=>{h(),t(ze(s,i,c))},[t,s,i,c,h]),[w,k]=Object(n.useState)(!1),C=Object(n.useCallback)(()=>{k(!w)},[w,k]);Object(n.useEffect)(()=>{const t=Array.from(e.files);d(t),u(-1),k(!1)},[e.files,u,k]);const O=Object(n.useRef)(null);Object(n.useEffect)(()=>{var e;null===(e=O.current)||void 0===e||e.scrollIntoView({block:"nearest",behavior:"smooth"})},[O,m]);const j=Object(n.useCallback)(()=>s.map((e,t)=>{const a=m===t,n=a?O:null;return r.a.createElement(ua.a,{key:`${t}`,disableGutters:!0,onClick:()=>u(t),ref:n,button:!0},r.a.createElement(et.a,null,r.a.createElement(pa.a,{checked:a,value:`track-${t}`,size:"small"})),r.a.createElement(tt.a,{primary:e.name}))}),[s,m,u,O]),D=Object(n.useCallback)((e,t)=>{const a=s.slice().concat(e);d(a)},[s,d]),{getRootProps:S,getInputProps:x,isDragActive:M,open:T}=Object(jt.a)({onDrop:D,accept:["audio/*","video/mp4"],noClick:!0}),N=m<0||m>=s.length,P=Object(n.useCallback)(()=>{const e=s.filter((e,t)=>t!==m);d(e),m>=e.length&&u(e.length-1)},[m,s,d]),I=b(e=>e.convertDialog.visible);return Object(n.useEffect)(()=>{I&&0===s.length&&h()},[s,I]),r.a.createElement($e.a,{open:l,maxWidth:"xs",fullWidth:!0,TransitionComponent:ga,"aria-labelledby":"convert-dialog-slide-title","aria-describedby":"convert-dialog-slide-description"},r.a.createElement(He.a,{id:"convert-dialog-slide-title"},"Upload Settings"),r.a.createElement(Ue.a,{className:a.dialogContent},r.a.createElement("div",{className:a.formatAndTitle},r.a.createElement(We.a,null,r.a.createElement(Fe.a,{component:"label",variant:"caption",color:"textSecondary"},"Recording Mode"),r.a.createElement(ea.a,{value:i,exclusive:!0,onChange:v,size:"small"},r.a.createElement(Zt.a,{className:a.toggleButton,value:"SP"},"SP"),r.a.createElement(Zt.a,{className:a.toggleButton,value:"LP2"},"LP2"),r.a.createElement(Zt.a,{className:a.toggleButton,value:"LP4"},"LP4"))),r.a.createElement("div",{className:a.rightBlock},r.a.createElement(We.a,{className:a.formControl},r.a.createElement(Fe.a,{component:"label",variant:"caption",color:"textSecondary"},"Track title"),r.a.createElement(We.a,{className:a.titleFormControl},r.a.createElement(ta.a,{value:c,color:"secondary",input:r.a.createElement(aa.a,null),onChange:y},r.a.createElement(Xe.a,{value:"filename"},"Filename"),r.a.createElement(Xe.a,{value:"title"},"Title"),r.a.createElement(Xe.a,{value:"album-title"},"Album - Title"),r.a.createElement(Xe.a,{value:"artist-title"},"Artist - Title"),r.a.createElement(Xe.a,{value:"artist-album-title"},"Artist - Album - Title")))))),r.a.createElement(na.a,{expanded:w,className:a.tracksOrderAccordion,square:!0},r.a.createElement("div",null),r.a.createElement("div",Object.assign({},S(),{style:{outline:"none"}}),r.a.createElement(Wt.a,{variant:"dense",className:a.toolbarHighlight},r.a.createElement(Ye.a,{edge:"start","aria-label":"add track",onClick:T},r.a.createElement(Mt.a,null)),r.a.createElement(Ye.a,{edge:"start","aria-label":"remove track",onClick:P,disabled:N},r.a.createElement(da.a,null)),r.a.createElement("div",{className:a.spacer}),r.a.createElement(Ye.a,{edge:"end","aria-label":"move up",onClick:f},r.a.createElement(ia.a,null)),r.a.createElement(Ye.a,{edge:"end","aria-label":"move down",onClick:g},r.a.createElement(ca.a,null))),r.a.createElement(ra.a,{className:a.tracksOrderAccordionDetail},r.a.createElement(ma.a,{dense:!0,disablePadding:!1,className:a.trackList},j())),r.a.createElement(Oe.a,{className:a.backdrop,open:M},"Drop your Music to add it to the queue"),r.a.createElement("input",x())))),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:C,className:a.showTracksOrderBtn},`${w?"Hide":"Show"} Tracks`),r.a.createElement("div",{className:a.spacer}),r.a.createElement(Re.a,{onClick:h},"Cancel"),r.a.createElement(Re.a,{onClick:E},"Ok")))};var ha=a(286),va=a.n(ha),ya=a(287),Ea=a.n(ya),wa=a(288),ka=a.n(wa),Ca=a(285),Oa=a.n(Ca);function ja(){return(ja=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Da=r.a.createElement("g",{fill:"#000",fillRule:"evenodd"},r.a.createElement("g",{fillRule:"nonzero"},r.a.createElement("path",{d:"M5.756 14.036l2.101 2.14c-2.173 2.135-3.623 4.401-4.303 6.721l-.101.367-2.906-.748c.776-3.013 2.552-5.872 5.209-8.48zM23.576 4.241l.902 2.861c-5.329 1.682-9.916 3.879-13.464 6.436l-.438.322-1.796-2.403c3.894-2.91 8.94-5.368 14.796-7.216zM47.825.5l.054 3c-6.79.122-13.336.962-19.288 2.445l-.846.216-.76-2.902C33.395 1.581 40.477.632 47.825.5zM92.67 14.036l-2.101 2.14c2.173 2.135 3.624 4.401 4.303 6.721l.101.367 2.906-.748c-.776-3.013-2.552-5.872-5.209-8.48zM74.85 4.241l-.902 2.861c5.329 1.682 9.916 3.879 13.464 6.436l.438.322 1.796-2.403c-3.893-2.91-8.94-5.368-14.796-7.216zM50.601.5l-.054 3c6.79.122 13.336.962 19.288 2.445l.846.216.76-2.902C65.031 1.581 57.95.632 50.601.5zM5.756 37.964l2.101-2.14c-2.173-2.135-3.623-4.401-4.303-6.721l-.101-.367-2.906.748c.776 3.013 2.552 5.872 5.209 8.48zM23.576 47.759l.902-2.861c-5.329-1.682-9.916-3.879-13.464-6.436l-.438-.322-1.796 2.403c3.894 2.91 8.94 5.368 14.796 7.216zM47.825 51.5l.054-3c-6.79-.122-13.336-.962-19.288-2.445l-.846-.216-.76 2.902c6.41 1.678 13.492 2.627 20.84 2.759zM92.67 37.964l-2.101-2.14c2.173-2.135 3.624-4.401 4.303-6.721l.101-.367 2.906.748c-.776 3.013-2.552 5.872-5.209 8.48zM74.85 47.759l-.902-2.861c5.329-1.682 9.916-3.879 13.464-6.436l.438-.322 1.796 2.403c-3.893 2.91-8.94 5.368-14.796 7.216zM50.601 51.5l-.054-3c6.79-.122 13.336-.962 19.288-2.445l.846-.216.76 2.902c-6.41 1.678-13.492 2.627-20.84 2.759z"})),r.a.createElement("path",{d:"M53.259 20.337c6.582-5.574 6.582-5.574 14.753-12.436C62.599 6.72 56.322 6 49.946 6c-6.485 0-12.82.747-18.303 1.966 6.675 5.894 7.084 6.191 14.006 12.252 3.48-.293 3.97-.293 7.61.12zM36.927 24.504c.992-1.544 2.25-2.448 5.124-3.474-5.486-4.744-7.34-6.324-14.003-12.173-11.485 3.264-19.33 9.02-20.049 15.647h28.928zM61.159 24.504c14.02 0 20.615 0 30.732-.004-.789-6.629-8.72-12.468-20.269-15.706-2.061 1.766-11.14 9.316-14.827 12.484 1.793.813 3.226 1.35 4.364 3.226zM40.996 30.602c-2.045-.884-3.476-1.935-4.042-3.102-1.056 0-26.431 0-28.782.039C9.53 33.6 16.924 38.847 27.455 41.964c4.236-3.528 8.255-6.948 13.541-11.362zM49.946 45c6.284 0 12.247-.64 17.6-1.79-4.721-4.135-7.729-6.721-13.454-11.689-3.681.692-6.213.59-9.6.068-4.888 4.125-10.974 9.218-13.473 11.324C36.707 44.248 43.137 45 49.946 45zM57.47 30.45c4.38 3.707 9.262 8.068 13.687 11.884 11.265-3.066 19.178-8.5 20.57-14.83H61.18c-.667.999-1.516 1.917-3.71 2.946z"}));const Sa=({svgRef:e,title:t,...a})=>r.a.createElement("svg",ja({width:98,height:52,viewBox:"0 0 98 52",ref:e},a),t?r.a.createElement("title",null,t):null,Da),xa=r.a.forwardRef((e,t)=>r.a.createElement(Sa,ja({svgRef:t},e)));a.p;function Ma(){return(Ma=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Ta=r.a.createElement("g",{fill:"#000",fillRule:"evenodd"},r.a.createElement("g",{fillRule:"nonzero"},r.a.createElement("path",{d:"M5.756 14.036l2.101 2.14c-2.173 2.135-3.623 4.401-4.303 6.721l-.101.367-2.906-.748c.776-3.013 2.552-5.872 5.209-8.48zM23.576 4.241l.902 2.861c-5.329 1.682-9.916 3.879-13.464 6.436l-.438.322-1.796-2.403c3.894-2.91 8.94-5.368 14.796-7.216zM47.825.5l.054 3c-6.79.122-13.336.962-19.288 2.445l-.846.216-.76-2.902C33.395 1.581 40.477.632 47.825.5zM92.67 14.036l-2.101 2.14c2.173 2.135 3.624 4.401 4.303 6.721l.101.367 2.906-.748c-.776-3.013-2.552-5.872-5.209-8.48zM74.85 4.241l-.902 2.861c5.329 1.682 9.916 3.879 13.464 6.436l.438.322 1.796-2.403c-3.893-2.91-8.94-5.368-14.796-7.216zM50.601.5l-.054 3c6.79.122 13.336.962 19.288 2.445l.846.216.76-2.902C65.031 1.581 57.95.632 50.601.5zM5.756 37.964l2.101-2.14c-2.173-2.135-3.623-4.401-4.303-6.721l-.101-.367-2.906.748c.776 3.013 2.552 5.872 5.209 8.48zM23.576 47.759l.902-2.861c-5.329-1.682-9.916-3.879-13.464-6.436l-.438-.322-1.796 2.403c3.894 2.91 8.94 5.368 14.796 7.216zM47.825 51.5l.054-3c-6.79-.122-13.336-.962-19.288-2.445l-.846-.216-.76 2.902c6.41 1.678 13.492 2.627 20.84 2.759zM92.67 37.964l-2.101-2.14c2.173-2.135 3.624-4.401 4.303-6.721l.101-.367 2.906.748c-.776 3.013-2.552 5.872-5.209 8.48zM74.85 47.759l-.902-2.861c5.329-1.682 9.916-3.879 13.464-6.436l.438-.322 1.796 2.403c-3.893 2.91-8.94 5.368-14.796 7.216zM50.601 51.5l-.054-3c6.79-.122 13.336-.962 19.288-2.445l.846-.216.76 2.902c-6.41 1.678-13.492 2.627-20.84 2.759z"})),r.a.createElement("path",{d:"M36.927 24.504c.992-1.544 2.25-2.448 5.124-3.474-5.486-4.744-7.34-6.324-14.003-12.173-11.485 3.264-19.33 9.02-20.049 15.647h28.928zM57.47 30.45c4.38 3.707 9.262 8.068 13.687 11.884 11.265-3.066 19.178-8.5 20.57-14.83H61.18c-.667.999-1.516 1.917-3.71 2.946z"}));const Na=({svgRef:e,title:t,...a})=>r.a.createElement("svg",Ma({width:98,height:52,viewBox:"0 0 98 52",ref:e},a),t?r.a.createElement("title",null,t):null,Ta),Pa=r.a.forwardRef((e,t)=>r.a.createElement(Na,Ma({svgRef:t},e)));a.p;function Ia(){return(Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var za=r.a.createElement("g",{fill:"#000",fillRule:"evenodd"},r.a.createElement("g",{fillRule:"nonzero"},r.a.createElement("path",{d:"M5.756 14.036l2.101 2.14c-2.173 2.135-3.623 4.401-4.303 6.721l-.101.367-2.906-.748c.776-3.013 2.552-5.872 5.209-8.48zM23.576 4.241l.902 2.861c-5.329 1.682-9.916 3.879-13.464 6.436l-.438.322-1.796-2.403c3.894-2.91 8.94-5.368 14.796-7.216zM47.825.5l.054 3c-6.79.122-13.336.962-19.288 2.445l-.846.216-.76-2.902C33.395 1.581 40.477.632 47.825.5zM92.67 14.036l-2.101 2.14c2.173 2.135 3.624 4.401 4.303 6.721l.101.367 2.906-.748c-.776-3.013-2.552-5.872-5.209-8.48zM74.85 4.241l-.902 2.861c5.329 1.682 9.916 3.879 13.464 6.436l.438.322 1.796-2.403c-3.893-2.91-8.94-5.368-14.796-7.216zM50.601.5l-.054 3c6.79.122 13.336.962 19.288 2.445l.846.216.76-2.902C65.031 1.581 57.95.632 50.601.5zM5.756 37.964l2.101-2.14c-2.173-2.135-3.623-4.401-4.303-6.721l-.101-.367-2.906.748c.776 3.013 2.552 5.872 5.209 8.48zM23.576 47.759l.902-2.861c-5.329-1.682-9.916-3.879-13.464-6.436l-.438-.322-1.796 2.403c3.894 2.91 8.94 5.368 14.796 7.216zM47.825 51.5l.054-3c-6.79-.122-13.336-.962-19.288-2.445l-.846-.216-.76 2.902c6.41 1.678 13.492 2.627 20.84 2.759zM92.67 37.964l-2.101-2.14c2.173-2.135 3.624-4.401 4.303-6.721l.101-.367 2.906.748c-.776 3.013-2.552 5.872-5.209 8.48zM74.85 47.759l-.902-2.861c5.329-1.682 9.916-3.879 13.464-6.436l.438-.322 1.796 2.403c-3.893 2.91-8.94 5.368-14.796 7.216zM50.601 51.5l-.054-3c6.79-.122 13.336-.962 19.288-2.445l.846-.216.76 2.902c-6.41 1.678-13.492 2.627-20.84 2.759z"})),r.a.createElement("path",{d:"M53.259 20.337c6.582-5.574 6.582-5.574 14.753-12.436C62.599 6.72 56.322 6 49.946 6c-6.485 0-12.82.747-18.303 1.966 6.675 5.894 7.084 6.191 14.006 12.252 3.48-.293 3.97-.293 7.61.12zM49.946 45c6.284 0 12.247-.64 17.6-1.79-4.721-4.135-7.729-6.721-13.454-11.689-3.681.692-6.213.59-9.6.068-4.888 4.125-10.974 9.218-13.473 11.324C36.707 44.248 43.137 45 49.946 45z"}));const Ra=({svgRef:e,title:t,...a})=>r.a.createElement("svg",Ia({width:98,height:52,viewBox:"0 0 98 52",ref:e},a),t?r.a.createElement("title",null,t):null,za),Fa=r.a.forwardRef((e,t)=>r.a.createElement(Ra,Ia({svgRef:t},e)));a.p;function Wa(){return(Wa=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Aa=r.a.createElement("g",{fill:"#000",fillRule:"evenodd"},r.a.createElement("g",{fillRule:"nonzero"},r.a.createElement("path",{d:"M5.756 14.036l2.101 2.14c-2.173 2.135-3.623 4.401-4.303 6.721l-.101.367-2.906-.748c.776-3.013 2.552-5.872 5.209-8.48zM23.576 4.241l.902 2.861c-5.329 1.682-9.916 3.879-13.464 6.436l-.438.322-1.796-2.403c3.894-2.91 8.94-5.368 14.796-7.216zM47.825.5l.054 3c-6.79.122-13.336.962-19.288 2.445l-.846.216-.76-2.902C33.395 1.581 40.477.632 47.825.5zM92.67 14.036l-2.101 2.14c2.173 2.135 3.624 4.401 4.303 6.721l.101.367 2.906-.748c-.776-3.013-2.552-5.872-5.209-8.48zM74.85 4.241l-.902 2.861c5.329 1.682 9.916 3.879 13.464 6.436l.438.322 1.796-2.403c-3.893-2.91-8.94-5.368-14.796-7.216zM50.601.5l-.054 3c6.79.122 13.336.962 19.288 2.445l.846.216.76-2.902C65.031 1.581 57.95.632 50.601.5zM5.756 37.964l2.101-2.14c-2.173-2.135-3.623-4.401-4.303-6.721l-.101-.367-2.906.748c.776 3.013 2.552 5.872 5.209 8.48zM23.576 47.759l.902-2.861c-5.329-1.682-9.916-3.879-13.464-6.436l-.438-.322-1.796 2.403c3.894 2.91 8.94 5.368 14.796 7.216zM47.825 51.5l.054-3c-6.79-.122-13.336-.962-19.288-2.445l-.846-.216-.76 2.902c6.41 1.678 13.492 2.627 20.84 2.759zM92.67 37.964l-2.101-2.14c2.173-2.135 3.624-4.401 4.303-6.721l.101-.367 2.906.748c-.776 3.013-2.552 5.872-5.209 8.48zM74.85 47.759l-.902-2.861c5.329-1.682 9.916-3.879 13.464-6.436l.438-.322 1.796 2.403c-3.893 2.91-8.94 5.368-14.796 7.216zM50.601 51.5l-.054-3c6.79-.122 13.336-.962 19.288-2.445l.846-.216.76 2.902c-6.41 1.678-13.492 2.627-20.84 2.759z"})),r.a.createElement("path",{d:"M61.159 24.504c14.02 0 20.615 0 30.732-.004-.789-6.629-8.72-12.468-20.269-15.706-2.061 1.766-11.14 9.316-14.827 12.484 1.793.813 3.226 1.35 4.364 3.226zM40.996 30.602c-2.045-.884-3.476-1.935-4.042-3.102-1.056 0-26.431 0-28.782.039C9.53 33.6 16.924 38.847 27.455 41.964c4.236-3.528 8.255-6.948 13.541-11.362z"}));const La=({svgRef:e,title:t,...a})=>r.a.createElement("svg",Wa({width:98,height:52,viewBox:"0 0 98 52",ref:e},a),t?r.a.createElement("title",null,t):null,Aa),Ba=r.a.forwardRef((e,t)=>r.a.createElement(La,Wa({svgRef:t},e)));a.p;const $a=[xa,Pa,Fa,Ba],Va=Object(De.a)(e=>({"@keyframes scrollLeft":{from:{transform:"translateX(0%)"},to:{}},container:{display:"flex",flex:"1 1 auto",[O(e)]:{flexWrap:"wrap"}},lcd:{flex:"1 1 auto",position:"relative",marginLeft:e.spacing(1.5),marginRight:e.spacing(1.5),paddingLeft:e.spacing(3),paddingRight:e.spacing(3),borderRadius:e.spacing(3),backgroundColor:e.palette.background.default,minWidth:150,height:48,[O(e)]:{marginLeft:0,marginRight:e.spacing(2)}},lcdText:{overflow:"hidden",position:"relative",width:"calc(100% - 40px)",left:40,height:"100%",fontFamily:"LCDDot"},lcdDisc:{position:"absolute",top:0,left:20},lcdDiscIcon:{width:28,height:48,"& g":{fill:e.palette.action.active}},scrollingStatusMessage:{position:"absolute",width:"100%",whiteSpace:"nowrap",animationName:"$scrollLeft",animationTimingFunction:"linear",animationIterationCount:"1",top:15,left:1},statusMessage:{position:"absolute",width:"100%",whiteSpace:"nowrap",top:15,left:1},button:{}})),Ua=()=>{var e,t,a;const l=Object(o.c)(),i=b(e=>e.main.deviceStatus),c=b(e=>e.main.disc),s=Va(),d=Object(n.useCallback)(()=>{l(Te("prev"))},[l]),m=Object(n.useCallback)(()=>{l(Te("play"))},[l]),u=Object(n.useCallback)(()=>{l(Te("stop"))},[l]),p=Object(n.useCallback)(()=>{l(Te("next"))},[l]);let g="",f=null!==(e=null===i||void 0===i?void 0:i.track)&&void 0!==e?e:null,h=null!==(t=null===i||void 0===i?void 0:i.state)&&void 0!==t?t:null,v=null!==(a=null===i||void 0===i?void 0:i.discPresent)&&void 0!==a&&a;const y=w(c);v?"readingTOC"===h?g="READING TOC":0===y.length?g="BLANKDISC":i&&null!==i.track&&(g=`${i.track+1} - `+y[i.track].title):g="";const[E,k]=Object(n.useState)(0),[C,O]=Object(n.useState)(0),[j,D]=Object(n.useState)(0),S=Object(n.useRef)(null),x=Object(n.useRef)(null);Object(n.useEffect)(()=>(clearTimeout(S.current),k(0),S.current=setTimeout(()=>{(()=>{var e,t,a;const n=x.current,r=null!==(e=null===n||void 0===n?void 0:n.scrollWidth)&&void 0!==e?e:0,l=null!==(t=null===n||void 0===n?void 0:null===(a=n.parentElement)||void 0===a?void 0:a.offsetWidth)&&void 0!==t?t:0,i=r>l?r/20:0;k(r>l?100*r/l:0),O(i),i>0&&(S.current=setTimeout(()=>{k(0)},1e3*i+500))})()},2e3),()=>{clearTimeout(S.current)}),[f,h,g]);const M=Object(n.useRef)(null);Object(n.useEffect)(()=>(clearInterval(M.current),"playing"===h||"readingTOC"===h?M.current=setInterval(()=>{D(1+j%($a.length-1))},600):D(0),()=>{clearInterval(M.current)}),[h,j]);const T=$a[j];return r.a.createElement(Le.a,{className:s.container},r.a.createElement(Ye.a,{"aria-label":"prev",onClick:d,className:s.button},r.a.createElement(Oa.a,null)),r.a.createElement(Ye.a,{"aria-label":"play",onClick:m,className:s.button},r.a.createElement(va.a,null)),r.a.createElement(Ye.a,{"aria-label":"stop",onClick:u,className:s.button},r.a.createElement(Ea.a,null)),r.a.createElement(Ye.a,{"aria-label":"next",onClick:p,className:s.button},r.a.createElement(ka.a,null)),r.a.createElement("div",{className:s.lcd},r.a.createElement("div",{className:s.lcdText},r.a.createElement("span",{className:E?s.scrollingStatusMessage:s.statusMessage,ref:x,style:g&&E>0?{animationDuration:`${C}s`,transform:`translate(-${E}%)`}:{}},g)),r.a.createElement("div",{className:s.lcdDisc},v&&r.a.createElement(T,{className:s.lcdDiscIcon}))))},_a=r.a.forwardRef((function(e,t){return r.a.createElement(Ge.a,Object.assign({direction:"up",ref:t},e))})),Ha=Object(De.a)(e=>({container:{display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",marginRight:-e.spacing(2),flexFlow:"wrap"},formControl:{minWidth:120},selectEmpty:{marginTop:e.spacing(2)},head:{textShadow:"0px 0px 12px rgba(150, 150, 150, 1)",fontSize:e.typography.h2.fontSize,textAlign:"center",marginBottom:e.spacing(2)}})),Ga=({trackIndexes:e})=>{const t=Object(o.c)(),a=Ha(),[l,i]=Object(n.useState)([]),[c,s]=Object(n.useState)("");let{visible:d}=b(e=>e.dumpDialog);const u=Object(n.useCallback)(()=>{var e;s(""),null===(e=T.mediaRecorderService)||void 0===e||e.stopTestInput(),t(re.setVisible(!1))},[t]),f=Object(n.useCallback)(e=>{var t,a;const n=e.target.value;s(n),null===(t=T.mediaRecorderService)||void 0===t||t.stopTestInput(),null===(a=T.mediaRecorderService)||void 0===a||a.playTestInput(n)},[s]),h=Object(n.useCallback)(()=>{var a,n;t((a=e,n=c,async function(e,t){e(Object(I.batchActions)([ce.setVisible(!0),ce.setProgress({trackTotal:a.length,trackDone:0,trackCurrent:0,titleCurrent:""})]));let r=t().main.disc,l=Object(m.getTracks)(r).filter(e=>a.indexOf(e.index)>=0);const{netmdService:i,mediaRecorderService:o}=T;await T.netmdService.stop();for(let[a,s]of l.entries()){var c;e(ce.setProgress({trackTotal:l.length,trackDone:a,trackCurrent:-1,titleCurrent:null!==(c=s.title)&&void 0!==c?c:""})),await i.gotoTrack(s.index),await i.play(),console.log("Waiting for track to be ready to play");let t=await i.getPosition(),r=[s.index,0,0,1];for(;null===t||!r.every((e,a)=>r[a]===t[a]);)await p(250),t=await i.getPosition();await i.pause(),await(null===i||void 0===i?void 0:i.gotoTrack(s.index)),console.log("Track is ready to play"),await(null===o||void 0===o?void 0:o.initStream(n)),await(null===o||void 0===o?void 0:o.startRecording()),await i.play();let d=s.duration/512;await g(1e3*d,t=>{var n;e(ce.setProgress({trackTotal:l.length,trackDone:a,trackCurrent:t,titleCurrent:null!==(n=s.title)&&void 0!==n?n:""}))}),await(null===o||void 0===o?void 0:o.stopRecording()),null===o||void 0===o||o.downloadRecorded(`${s.title}`),await(null===o||void 0===o?void 0:o.closeStream())}await i.stop(),e(ce.setVisible(!1))})),u()},[e,c,t,u]);return Object(n.useEffect)(()=>{d&&async function(){await navigator.mediaDevices.getUserMedia({audio:!0});let e=(await navigator.mediaDevices.enumerateDevices()).filter(e=>"audioinput"===e.kind).map(e=>({deviceId:e.deviceId,label:e.label}));i(e)}()},[d,i]),r.a.createElement($e.a,{open:d,maxWidth:"sm",fullWidth:!0,TransitionComponent:_a,"aria-labelledby":"dump-dialog-slide-title","aria-describedby":"dump-dialog-slide-description"},r.a.createElement(He.a,{id:"dump-dialog-slide-title"},"Record Selected Tracks"),r.a.createElement(Ue.a,null,r.a.createElement(Fe.a,{component:"p",variant:"h2",className:a.head},"\ud83d\udcbb \u2b05 \ud83d\udcbd"),r.a.createElement(Fe.a,{component:"p",variant:"body2"},"1. Connect your MD Player line-out to your PC audio line-in."),r.a.createElement(Fe.a,{component:"p",variant:"body2"},"2. Use the controls at the bottom right to play some tracks."),r.a.createElement(Fe.a,{component:"p",variant:"body2"},"3. Select the input source. You should hear the tracks playing on your PC."),r.a.createElement(Fe.a,{component:"p",variant:"body2"},"4. Adjust the input gain and the line-out volume of your device."),r.a.createElement(Le.a,{className:a.container},r.a.createElement(We.a,{className:a.formControl},r.a.createElement(ta.a,{value:c,onChange:f,displayEmpty:!0,className:a.selectEmpty},r.a.createElement(Xe.a,{value:"",disabled:!0},"Input Source"),l.map(e=>r.a.createElement(Xe.a,{key:e.deviceId,value:e.deviceId},e.label))),r.a.createElement(Ae.a,null,"Input Source")),r.a.createElement(Ua,null))),r.a.createElement(Ve.a,null,r.a.createElement(Re.a,{onClick:u},"Cancel"),r.a.createElement(Re.a,{onClick:h,disabled:""===c},"Start Record")))};var Ja=a(625),qa=a(188);const Ya=Object(De.a)(e=>({add:{position:"absolute",bottom:e.spacing(3),right:e.spacing(3),[O(e)]:{bottom:e.spacing(2)}},main:{overflowY:"auto",flex:"1 1 auto",marginBottom:e.spacing(3),outline:"none",marginLeft:e.spacing(-1),marginRight:e.spacing(-1),[C(e)]:{marginLeft:e.spacing(-2),marginRight:e.spacing(-2)}},toolbar:{marginTop:e.spacing(3),marginLeft:e.spacing(-2),marginRight:e.spacing(-2),[e.breakpoints.up(600+2*e.spacing(2))]:{marginLeft:e.spacing(-3),marginRight:e.spacing(-3)}},toolbarLabel:{flex:"1 1 100%"},toolbarHighlight:"light"===e.palette.type?{color:e.palette.secondary.main,backgroundColor:Object(Dt.d)(e.palette.secondary.light,.85)}:{color:e.palette.text.primary,backgroundColor:e.palette.secondary.dark},headBox:{display:"flex",justifyContent:"space-between"},spacing:{marginTop:e.spacing(1)},formatBadge:{...qa.styles(e).badge,...qa.styles(e).colorPrimary,position:"static",display:"inline-flex",border:`2px solid ${e.palette.background.paper}`,padding:"0 4px",verticalAlign:"middle",width:e.spacing(4.5),marginRight:e.spacing(.5)},titleCell:{overflow:"hidden",maxWidth:"40ch",textOverflow:"ellipsis"},durationCell:{whiteSpace:"nowrap"},durationCellTime:{verticalAlign:"middle"},indexCell:{whiteSpace:"nowrap",paddingRight:0,width:"2ch"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},remainingTimeTooltip:{textDecoration:"underline",textDecorationStyle:"dotted"}})),Ka=e=>{let t=Object(o.c)(),a=b(e=>e.main.disc),l=b(e=>e.main.deviceName);const[i,c]=r.a.useState([]),s=i.length,[d,u]=r.a.useState(null),p=Object(n.useCallback)(e=>{u(e.currentTarget)},[]),g=Object(n.useCallback)(()=>{u(null)},[]),f=Object(n.useCallback)(e=>{t(function(e,t){return async function(a){const{netmdService:n}=T;await n.moveTrack(e,t),Ne()(a)}}(i[0],e)),g()},[t,i,g]),h=Object(n.useCallback)(()=>{t(re.setVisible(!0))},[t]);Object(n.useEffect)(()=>{t(Ne())},[t]),Object(n.useEffect)(()=>{c([])},[a]);let[v,y]=r.a.useState([]);const E=Object(n.useCallback)((e,a)=>{y(e),t(Z.setVisible(!0))},[t]),{getRootProps:k,getInputProps:C,isDragActive:O,open:j}=Object(jt.a)({onDrop:E,accept:["audio/*","video/mp4"],noClick:!0}),D=Ya(),S=w(a),x=(e,n)=>{var r,l;let i=n,o=null!==(r=null===(l=Object(m.getTracks)(a).find(e=>e.index===i))||void 0===l?void 0:l.title)&&void 0!==r?r:"";t(Object(I.batchActions)([B.setVisible(!0),B.setCurrentName(o),B.setIndex(i)]))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(Le.a,{className:D.headBox},r.a.createElement(Fe.a,{component:"h1",variant:"h4"},l||"Loading..."),r.a.createElement(yt,null)),r.a.createElement(Fe.a,{component:"h2",variant:"body2"},null!==a?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,`${Object(m.formatTimeFromFrames)(a.left,!1)} left of ${Object(m.formatTimeFromFrames)(a.total,!1)} `),r.a.createElement(At.a,{title:r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,`${Object(m.formatTimeFromFrames)(2*a.left,!1)} left in LP2 Mode`),r.a.createElement("br",null),r.a.createElement("span",null,`${Object(m.formatTimeFromFrames)(4*a.left,!1)} left in LP4 Mode`)),arrow:!0},r.a.createElement("span",{className:D.remainingTimeTooltip},"SP Mode"))):"Loading..."),r.a.createElement(Wt.a,{className:Object(Ot.default)(D.toolbar,{[D.toolbarHighlight]:s>0})},s>0?r.a.createElement(Ja.a,{indeterminate:s>0&&s<S.length,checked:s>0,onChange:e=>{i.length<S.length?c(S.map(e=>e.index)):c([])},inputProps:{"aria-label":"select all tracks"}}):null,s>0?r.a.createElement(Fe.a,{className:D.toolbarLabel,color:"inherit",variant:"subtitle1"},s," selected"):r.a.createElement(Fe.a,{component:"h3",variant:"h6",className:D.toolbarLabel},(null===a||void 0===a?void 0:a.title)||"Untitled Disc"),1===s?r.a.createElement(r.a.Fragment,null,r.a.createElement(At.a,{title:"Move to Position"},r.a.createElement(Re.a,{"aria-controls":"move-menu","aria-label":"Move",onClick:p},"Move")),r.a.createElement(Ke.a,{id:"move-menu",anchorEl:d,open:!!d,onClose:g,PaperProps:{style:{maxHeight:300}}},Array(S.length).fill(null).map((e,t)=>r.a.createElement(Xe.a,{key:`pos-${t}`,onClick:()=>f(t)},t+1)))):null,s>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(At.a,{title:"Record from MD"},r.a.createElement(Re.a,{"aria-label":"Record",onClick:h},"Record"))):null,s>0?r.a.createElement(At.a,{title:"Delete"},r.a.createElement(Ye.a,{"aria-label":"delete",onClick:e=>{var a;t((a=i,async function(e){if(!window.confirm(`Proceed with Delete Track${1!==a.length?"s":""}? This operation cannot be undone.`))return;const{netmdService:t}=T;e(pe.setLoading(!0)),(a=a.sort()).reverse();for(let n of a)await t.deleteTrack(n);Ne()(e)}))}},r.a.createElement(Nt.a,null))):null,s>0?r.a.createElement(At.a,{title:"Rename"},r.a.createElement(Ye.a,{"aria-label":"rename",disabled:1!==s,onClick:e=>{x(0,i[0])}},r.a.createElement(lt.a,null))):null),r.a.createElement(Le.a,Object.assign({className:D.main},k()),r.a.createElement("input",C()),r.a.createElement(Pt.a,{size:"small"},r.a.createElement(Rt.a,null,r.a.createElement(Ft.a,null,r.a.createElement(zt.a,{className:D.indexCell},"#"),r.a.createElement(zt.a,null,"Title"),r.a.createElement(zt.a,{align:"right"},"Duration"))),r.a.createElement(It.a,null,S.map(e=>r.a.createElement(Ft.a,{hover:!0,selected:i.includes(e.index),key:e.index,onDoubleClick:t=>x(0,e.index),onClick:t=>{return a=e.index,void(i.includes(a)?c(i.filter(e=>e!==a)):c([...i,a]));var a}},r.a.createElement(zt.a,{className:D.indexCell},e.index+1),r.a.createElement(zt.a,{className:D.titleCell,title:e.title},e.title||"No Title"),r.a.createElement(zt.a,{align:"right",className:D.durationCell},r.a.createElement("span",{className:D.formatBadge},e.encoding),r.a.createElement("span",{className:D.durationCellTime},e.duration)))))),r.a.createElement(Oe.a,{className:D.backdrop,open:O},"Drop your Music to Upload")),r.a.createElement(St.a,{color:"primary","aria-label":"add",className:D.add,onClick:j},r.a.createElement(Mt.a,null)),r.a.createElement(Ht,null),r.a.createElement($t,null),r.a.createElement(Kt,null),r.a.createElement(fa,{files:v}),r.a.createElement(qt,null),r.a.createElement(Ga,{trackIndexes:i}),r.a.createElement(qe,null),r.a.createElement(Qt,null))};var Xa=a(554);const Qa=Object(De.a)(e=>({layout:{width:"auto",height:"100%",[C(e)]:{width:600,marginLeft:"auto",marginRight:"auto"},[j(e)]:{width:700}},paper:{position:"relative",display:"flex",flexDirection:"column",padding:e.spacing(2),height:"calc(100% - 20px)",[C(e)]:{marginTop:e.spacing(2),marginBottom:e.spacing(1),padding:e.spacing(3),height:600},[j(e)]:{height:700}},bottomBar:{display:"flex",alignItems:"center",[O(e)]:{flexWrap:"wrap"},marginLeft:-e.spacing(2)},copyrightTypography:{marginRight:e.spacing(1),textAlign:"center"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},minidiscLogo:{width:48},controlsContainer:{flex:"0 0 auto",width:"100%",paddingRight:e.spacing(8),[O(e)]:{paddingLeft:0}}})),Za=Object(Se.a)({palette:{type:"dark",primary:{light:"#6ec6ff",main:"#2196f3",dark:"#0069c0",contrastText:"#fff"}}}),en=Object(Se.a)({palette:{type:"light"}});var tn=()=>{const e=Qa();Object(o.c)();let{mainView:t,loading:a,darkMode:n}=b(e=>e.appState);return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe.a,{theme:n?Za:en},r.a.createElement(Ce.a,null),r.a.createElement("main",{className:e.layout},r.a.createElement(Xa.a,{className:e.paper},"WELCOME"===t?r.a.createElement(Ct,null):null,"MAIN"===t?r.a.createElement(Ka,null):null,r.a.createElement(Le.a,{className:e.controlsContainer},"MAIN"===t?r.a.createElement(Ua,null):null)),r.a.createElement(Fe.a,{variant:"body2",color:"textSecondary",className:e.copyrightTypography},"\xa9 ",r.a.createElement(Be.a,{rel:"noopener noreferrer",color:"inherit",target:"_blank",href:"https://stefano.brilli.me/"},"Stefano Brilli")," ",(new Date).getFullYear(),".")),r.a.createElement(Oe.a,{className:e.backdrop,open:a},r.a.createElement(je.a,{color:"inherit"}))))},an=(a(536),a(537),a(189));class nn{constructor(e){this.worker=e,this.messageCallback=void 0,e.onmessage=this.handleMessage.bind(this)}async init(){await new Promise(e=>{this.messageCallback=e,this.worker.postMessage({action:"init"})})}async encode(e,t){return(await new Promise(a=>{this.messageCallback=a,this.worker.postMessage({action:"encode",bitrate:t,data:e},[e])})).data.result}terminate(){this.worker.terminate()}handleMessage(e){this.messageCallback(e),this.messageCallback=void 0}}if("undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){let e;onmessage=async t=>{const{action:a,...n}=t.data;if("init"===a)self.importScripts(f("atracdenc.js")),self.Module().then(t=>{e=t,self.postMessage({action:"init"}),e.setLogger&&e.setLogger((e,t)=>console.log(`${t}: ${e}`))});else if("encode"===a){const{bitrate:t,data:a}=n,r="inWavFile.wav",l="outAt3File.aea",i=new Uint8Array(a);e.FS.writeFile(`${r}`,i),e.callMain(["-e","atrac3","-i",r,"-o",l,"--bitrate",t]);let o=e.FS.stat(l).size,c=new Uint8Array(o-96),s=e.FS.open(l,"r");e.FS.read(s,c,0,c.length,96),e.FS.close(s);let d=c.buffer;self.postMessage({action:"encode",result:d},[d])}}}const rn=a(552);var ln=a(291),on=a.n(ln);T.netmdService=new M({debug:!0}),T.audioExportService=new class{constructor(){this.ffmpegProcess=void 0,this.atracdencProcess=void 0,this.loglines=[],this.inFileName="",this.outFileNameNoExt=""}async init(){Object(an.setLogging)(!0)}async prepare(e){this.loglines=[],this.ffmpegProcess=Object(an.createWorker)({logger:e=>{this.loglines.push(e),console.log(e.action,e.message)},corePath:f("ffmpeg-core.js"),workerPath:f("worker.min.js")}),await this.ffmpegProcess.load(),this.atracdencProcess=new nn(new rn),await this.atracdencProcess.init();let t=e.name.split(".").slice(-1);if(0===t.length)throw new Error(`Unrecognized file format: ${e.name}`);this.inFileName=`inAudioFile.${t[0]}`,this.outFileNameNoExt="outAudioFile",await this.ffmpegProcess.write(this.inFileName,e)}async info(){await this.ffmpegProcess.transcode(this.inFileName,`${this.outFileNameNoExt}.metadata`,"-f ffmetadata");let e=/Audio:\s(.*?),/,t=/Input #0,\s(.*?),/,a=null,n=null;for(let r of this.loglines){let l=r.message.match(e);if(null===l)if(l=r.message.match(t),null===l){if(null!==a&&null!==n)break}else n=l[1];else a=l[1]}return{format:a,input:n}}async export({format:e}){let t;if("SP"===e){const e=`${this.outFileNameNoExt}.raw`;await this.ffmpegProcess.transcode(this.inFileName,e,"-f s16be -ar 44100");let{data:a}=await this.ffmpegProcess.read(e);t=a.buffer}else{const a=`${this.outFileNameNoExt}.wav`;await this.ffmpegProcess.transcode(this.inFileName,a,"-f wav -ar 44100");let{data:n}=await this.ffmpegProcess.read(a),r="0";switch(e){case"LP2":r="128";break;case"LP105":r="102";break;case"LP4":r="64"}t=await this.atracdencProcess.encode(n.buffer,r)}return this.ffmpegProcess.worker.terminate(),this.atracdencProcess.terminate(),t}},T.mediaRecorderService=new class{constructor(){this.recorder=void 0,this.stream=void 0,this.audioContext=void 0,this.analyserNode=void 0,this.gainNode=void 0}playTestInput(e){this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.analyserNode=this.audioContext.createAnalyser(),this.initStream(e).then(()=>{this.audioContext.createMediaStreamSource(this.stream).connect(this.gainNode),this.gainNode.connect(this.analyserNode),this.analyserNode.connect(this.audioContext.destination)})}stopTestInput(){var e;this.audioContext&&(null===(e=this.audioContext)||void 0===e||e.close(),delete this.audioContext,this.closeStream())}async initStream(e){const t={autoGainControl:!1,channelCount:2,deviceId:e,echoCancellation:!1,noiseSuppression:!1,sampleRate:44100,highpassFilter:!1};this.stream=await navigator.mediaDevices.getUserMedia({audio:t});const a=this.stream.getAudioTracks();a.length>0&&console.log("Record Setings:",a[0].getSettings())}async startRecording(){this.audioContext=new AudioContext;const e=this.audioContext.createMediaStreamSource(this.stream);this.recorder=new on.a(e,{workerPath:f("recorderWorker.js")}),this.recorder.record()}async stopRecording(){this.recorder.stop()}async closeStream(){var e;null===(e=this.stream)||void 0===e||e.getTracks().forEach(e=>e.stop())}downloadRecorded(e){this.recorder.exportWAV(t=>{let a=URL.createObjectURL(t),n=document.createElement("a");document.body.appendChild(n),n.style.display="none",n.href=a,n.download=`${y(e)}.wav`,n.click(),window.URL.revokeObjectURL(a),document.body.removeChild(n)})}},function(){let e;window.addEventListener("beforeunload",e=>{we.getState().uploadDialog.visible&&(e.preventDefault(),e.returnValue="Warning! Recording will be interrupted")}),navigator&&navigator.usb?navigator.usb.ondisconnect=function(){we.dispatch(pe.setState("WELCOME"))}:we.dispatch(pe.setBrowserSupported(!1)),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t})}(),function(){let e=null,t=!1;function a(e){var a;return!t&&"MAIN"===e.appState.mainView&&!1===e.appState.loading&&"playing"===(null===(a=e.main.deviceStatus)||void 0===a?void 0:a.state)&&!1===e.convertDialog.visible&&!1===e.uploadDialog.visible&&!1===e.recordDialog.visible&&!1===e.panicDialog.visible&&!1===e.errorDialog.visible&&!1===e.dumpDialog.visible}we.subscribe((function(){const n=we.getState();!0===a(n)&&null===e?e=setInterval(async()=>{try{const e=await T.netmdService.getDeviceStatus();we.dispatch(he.setDeviceStatus(e))}catch(e){console.error(e),t=!0}},5e3):!1===a(n)&&null!==e&&(clearInterval(e),e=null)}))}(),i.a.render(r.a.createElement(o.a,{store:we},r.a.createElement(tn,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/webminidisc",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="/webminidisc/final-service-worker.js";c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(a=>{const n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):s(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):s(t,e)})}}()}},[[312,1,2]]]);
//# sourceMappingURL=main.1aed9c03.chunk.js.map